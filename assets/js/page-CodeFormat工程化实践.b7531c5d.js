(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{1073:function(s,t,a){"use strict";a.r(t);var n=a(1),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"code-format-工程化实践"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#code-format-工程化实践"}},[s._v("#")]),s._v(" Code Format 工程化实践")]),s._v(" "),n("p",[s._v("代码规范和质量是工作中很重要的一部分，目前有很多工具可以帮助我们处理。")]),s._v(" "),n("h2",{attrs:{id:"工具分类介绍"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#工具分类介绍"}},[s._v("#")]),s._v(" 工具分类介绍")]),s._v(" "),n("p",[s._v("检测代码的工具很多，主要分为三类：")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("第一类：代码格式化工具，专注代码结构美化，不处理任何有关语法的内容")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://prettier.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Prettier"),n("OutboundLink")],1),s._v("：专注代码格式化")]),s._v(" "),n("li",[n("a",{attrs:{href:"https://stylelint.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Stylelint"),n("OutboundLink")],1),s._v("：专注 CSS 语法格式化")])])]),s._v(" "),n("li",[n("p",[s._v("第二类：lint 类，这些工具也支持处理代码格式，但重点是检测代码语法质量")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://cn.eslint.org/",target:"_blank",rel:"noopener noreferrer"}},[s._v("ESLint"),n("OutboundLink")],1),s._v("：可以配置代码格式规则，也可以检测代码语法质量")])])]),s._v(" "),n("li",[n("p",[s._v("第三类：将不同的工具进行合成，成为一个包含子功能或者有定制功能的插件，可以避免 Prettier 和 Lint 二者在代码处理上的冲突")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://github.com/prettier/eslint-config-prettier",target:"_blank",rel:"noopener noreferrer"}},[s._v("eslint-config-prettier"),n("OutboundLink")],1),s._v("：ESLint 检测和 Prettier 格式化")]),s._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/prettier/tslint-config-prettier",target:"_blank",rel:"noopener noreferrer"}},[s._v("tslint-config-prettier"),n("OutboundLink")],1),s._v("：TS 检测和代码格式化")]),s._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/okonet/lint-staged",target:"_blank",rel:"noopener noreferrer"}},[s._v("lint-staged"),n("OutboundLink")],1),s._v("：仅过滤 Git 暂存区上的文件，可以有效避免每次提交处理所有文件")])])])]),s._v(" "),n("p",[s._v("这些工具配置都比较相似，但尤其要注意版本的不同，导致的配置不同。")]),s._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("小贴士")]),s._v(" "),n("p",[s._v("Git 暂存区：执行命令 "),n("code",[s._v("git add")]),s._v(" 后，要提交的代码存放的空间。")])]),s._v(" "),n("h2",{attrs:{id:"工具原理和配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#工具原理和配置"}},[s._v("#")]),s._v(" 工具原理和配置")]),s._v(" "),n("h3",{attrs:{id:"原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#原理"}},[s._v("#")]),s._v(" 原理")]),s._v(" "),n("p",[s._v("Prettier、ESLint：")]),s._v(" "),n("p",[s._v("两者的工作原理是将代码解析成 AST，再通过我们写的配置，还原格式化后的代码，具体转化可以到"),n("a",{attrs:{href:"https://cn.eslint.org/parser/",target:"_blank",rel:"noopener noreferrer"}},[s._v("这个网站"),n("OutboundLink")],1),s._v("体验下。")]),s._v(" "),n("p",[s._v("lint-staged、commitlint、husky：")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("lint-staged")]),s._v(" 是获取 "),n("code",[s._v("git add")]),s._v(" 后暂存区的代码。")]),s._v(" "),n("li",[n("code",[s._v("commitlint")]),s._v(" 是获取 "),n("code",[s._v("git commit")]),s._v(" 的描述信息然后对格式进行规则校验。")]),s._v(" "),n("li",[n("code",[s._v("husky")]),s._v(" 是将 Git 内置的勾子函数暴露出来，便于配置。")])]),s._v(" "),n("h3",{attrs:{id:"配置对比"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置对比"}},[s._v("#")]),s._v(" 配置对比")]),s._v(" "),n("p",[s._v("这些自动化工具，可以在不同的地方进行配置，版本也不同，看起来很复杂，其实并没有，除了注意大版本的不同，其他的配置方式都大同小异。")]),s._v(" "),n("p",[s._v("这里整理下这些配置通用的部分，后面就不再分开写，只展示 "),n("code",[s._v("package.json")]),s._v(" 这一种方式。")]),s._v(" "),n("div",{staticStyle:{"text-align":"center"}},[n("img",{attrs:{src:a(668),alt:"自动化工具配置对比"}}),s._v(" "),n("p",{staticStyle:{"text-align":"center",color:"#888"}},[s._v("（自动化工具配置对比）")])]),s._v(" "),n("h2",{attrs:{id:"代码格式美化-prettier"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#代码格式美化-prettier"}},[s._v("#")]),s._v(" 代码格式美化：Prettier")]),s._v(" "),n("h3",{attrs:{id:"插件使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#插件使用"}},[s._v("#")]),s._v(" 插件使用")]),s._v(" "),n("p",[s._v("安装 Prettier 插件：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" --save-dev --save-exact prettier\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("执行命令：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("npx prettier --write "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("发现当前所有目录下的文件，都进行了格式化。")]),s._v(" "),n("p",[n("code",[s._v("prettier")]),s._v(" 格式有一套默认的格式化规则，一般情况下，选择默认就可以了。")]),s._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("小贴士")]),s._v(" "),n("p",[s._v("当然也可以自行配置，有两种配置方法：")]),s._v(" "),n("ul",[n("li",[s._v("在 package.json 中添加关键词 "),n("code",[s._v("prettier")])]),s._v(" "),n("li",[s._v("在项目根目录下新建 "),n("code",[s._v(".prettierrc")]),s._v(" 文件，js、json、yaml 等也可以。")])]),s._v(" "),n("p",[s._v("下面就不采用 package.json 中配置的方式了，具体关键字可以查看上面的表格。我们统一通过配置文件进行配置，其他的工具也是一样的。")])]),s._v(" "),n("p",[s._v("在根目录下新建文件 "),n("code",[s._v(".prettierrc")]),s._v("，具体有哪些配置项可写，可以参考官方文档：")]),s._v(" "),n("div",{staticClass:"language-json line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"singleQuote"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"printWidth"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("120")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"arrowParens"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"avoid"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"trailingComma"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"none"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("此时 Prettier 根据 "),n("code",[s._v(".prettierrc")]),s._v(" 定义的规则，对整个项目做了格式化操作。但一些场景下需要我们对个别文件进行处理，可以通过覆盖配置来实现。")]),s._v(" "),n("h3",{attrs:{id:"覆盖配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#覆盖配置"}},[s._v("#")]),s._v(" 覆盖配置")]),s._v(" "),n("p",[s._v("修改 "),n("code",[s._v(".prettierrc")]),s._v(" 文件，添加 "),n("code",[s._v("overrides")]),s._v(" 字段：")]),s._v(" "),n("div",{staticClass:"language-json line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"semi"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"overrides"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"files"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*.test.js"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"options"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"semi"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"files"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*.html"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"legacy/**/*.js"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"options"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"tabWidth"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])]),n("p",[s._v("这样针对 "),n("code",[s._v("test.js")]),s._v(" 文件、"),n("code",[s._v("html")]),s._v(" 文件和 "),n("code",[s._v("legacy/**/*.js")]),s._v(" 的格式就会按当前配置走。")]),s._v(" "),n("h3",{attrs:{id:"忽略文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#忽略文件"}},[s._v("#")]),s._v(" 忽略文件")]),s._v(" "),n("p",[s._v("如果想要忽略某个文件的格式化，可以新建文件 "),n("code",[s._v(".prettierignore")]),s._v("，添加要忽略的文件：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("/dist\n*.html\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h2",{attrs:{id:"代码质量检测-eslint"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#代码质量检测-eslint"}},[s._v("#")]),s._v(" 代码质量检测：ESLint")]),s._v(" "),n("h3",{attrs:{id:"插件使用-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#插件使用-2"}},[s._v("#")]),s._v(" 插件使用")]),s._v(" "),n("p",[s._v("安装 ESLint 插件：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" eslint --save-dev\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("新建配置文件：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("./node_modules/.bin/eslint --init\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("上述命令行会弹出选择提示，根据需要选择 eslint 规则，最后会在根目录下生成 "),n("code",[s._v(".eslintrc.js")]),s._v(" 文件：")]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[s._v("module"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"env"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"browser"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"es2021"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"extends"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"eslint:recommended"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"plugin:react/recommended"')]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"parserOptions"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"ecmaFeatures"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"jsx"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"ecmaVersion"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"latest"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"sourceType"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"module"')]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"plugins"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"react"')]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"rules"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"quotes"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"error"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"double"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br")])]),n("ul",[n("li",[s._v("env：包含了执行环境配置，浏览器环境、Node 环境或支持 ES5、ES6。")]),s._v(" "),n("li",[s._v("extends：使用的扩展配置，这里主要是引入一些集成好的检测规则")]),s._v(" "),n("li",[s._v("parseOptioins：解析器配置")]),s._v(" "),n("li",[s._v("plugins：引入的 eslint 插件")]),s._v(" "),n("li",[s._v("rules：用来定义具体规则，检查缩进，函数是否有返回值等。")])]),s._v(" "),n("p",[s._v("第一个参数，如果只有一个参数，直接使用字符串或数字就可以了：")]),s._v(" "),n("ul",[n("li",[n("code",[s._v('"off"')]),s._v(" 或 "),n("code",[s._v("0")]),s._v("：关闭规则")]),s._v(" "),n("li",[n("code",[s._v('"warn"')]),s._v(" 或 "),n("code",[s._v("1")]),s._v("：开启规则，使用警告级别的错误："),n("code",[s._v("warn")]),s._v("（不会导致程序退出，即可以正常提交代码）\n"),n("code",[s._v('"error"')]),s._v(" 或 "),n("code",[s._v("2")]),s._v("：开启规则，使用错误级别的错误："),n("code",[s._v("error")]),s._v("（当被触发的时候，程序会退出，存在 error 告警不能提交代码）")])]),s._v(" "),n("p",[s._v("第二个参数，你想要的配置参数：")]),s._v(" "),n("ul",[n("li",[n("code",[s._v('"quotes": ["error", "double"]')]),s._v("，如果存在单引号的就报错，终止提交。")]),s._v(" "),n("li",[n("code",[s._v('"quotes": ["warn", "double"]')]),s._v("，如果存在单引号就告警，但可以正常提交。")])]),s._v(" "),n("p",[s._v("ESLint 的"),n("a",{attrs:{href:"https://cn.eslint.org/docs/rules/",target:"_blank",rel:"noopener noreferrer"}},[s._v("配置规则"),n("OutboundLink")],1),s._v("。")]),s._v(" "),n("p",[s._v("执行如下命令，ESLint 就会对代码进行检测：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("./node_modules/.bin/eslint src/*.js\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("注意，如果项目根目录配置了 "),n("code",[s._v(".eslintrc")]),s._v("，那么 "),n("code",[s._v("package.json")]),s._v(" 中配置的 "),n("code",[s._v("eslintConfig")]),s._v(" 将不会生效。")]),s._v(" "),n("h3",{attrs:{id:"覆盖配置-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#覆盖配置-2"}},[s._v("#")]),s._v(" 覆盖配置")]),s._v(" "),n("p",[s._v("如果基于官方推荐的配置，想要在这个基础上修改某个规则怎么办，使用 overrides 来覆盖，可以指定使用的范围。")]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"rules"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"overrides"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"files"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./src/*.js"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"rules"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"no-console"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"error"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v("上面这个就可以针对指定的文件，让 "),n("code",[s._v("no-console")]),s._v(" 告警出来了。")]),s._v(" "),n("h2",{attrs:{id:"git-暂存区代码过滤-lint-staged"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#git-暂存区代码过滤-lint-staged"}},[s._v("#")]),s._v(" Git 暂存区代码过滤：lint-staged")]),s._v(" "),n("p",[s._v("在实际使用过程，会遇到这样的问题：")]),s._v(" "),n("ul",[n("li",[s._v("每次都要全局处理代码，浪费时间")]),s._v(" "),n("li",[s._v("每个人对所有代码格式化，规则不同，导致大量代码冲突")])]),s._v(" "),n("p",[s._v("lint-staged 可以实现：仅过滤 Git 暂存区的代码。")]),s._v(" "),n("h3",{attrs:{id:"插件使用-3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#插件使用-3"}},[s._v("#")]),s._v(" 插件使用")]),s._v(" "),n("p",[s._v("安装 lint-staged 插件：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" lint-staged --save-dev\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("在 "),n("code",[s._v("package.json")]),s._v(" 中配置 lint-staged：")]),s._v(" "),n("div",{staticClass:"language-json line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"lint-staged"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"*.js"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prettier -w ."')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"*.js"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"eslint . --fix"')]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("执行命令：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改业务代码")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" commit -m "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test lint-staged"')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("此时发现，这些命令仅对暂存区 "),n("code",[s._v("*.js")]),s._v(" 的内容进行了格式化。")]),s._v(" "),n("h2",{attrs:{id:"git-提交规范自动化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#git-提交规范自动化"}},[s._v("#")]),s._v(" Git 提交规范自动化")]),s._v(" "),n("p",[s._v("优秀的开源项目，对提交代码的描述信息都是很规范的。想要和这些项目一样清晰，我们可以借助插件 commitlint。关于这个可以参考下一篇文章 "),n("RouterLink",{attrs:{to:"/project/solutions/git-hooks/"}},[s._v("Git Hooks 工程化实践")]),s._v("。")],1),s._v(" "),n("p",[s._v("（完）")])])}),[],!1,null,null,null);t.default=e.exports},668:function(s,t,a){s.exports=a.p+"assets/img/auto-format-tools.72ce39ca.svg"}}]);